<div class="dialog-card">
  <h2>Edit Single</h2>
  <p>Update single metadata</p>

  <form [formGroup]="form" (ngSubmit)="save()">
    <mat-form-field appearance="outline" class="full">
      <mat-label>Title</mat-label>
      <input matInput formControlName="title">
      <mat-error *ngIf="form.get('title')?.invalid && form.get('title')?.touched">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full">
      <mat-label>Genres</mat-label>
      <mat-select formControlName="genres" multiple>
        <mat-option *ngFor="let g of availableGenres" [value]="g.genreId">{{ g.genreName }}</mat-option>
      </mat-select>
      <mat-error *ngIf="form.get('genres')?.invalid && form.get('genres')?.touched">Select at least one</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full">
      <mat-label>Artists</mat-label>
      <mat-select formControlName="artistIds" multiple>
        <mat-option *ngFor="let a of availableArtists" [value]="a.artistId">{{ a.name }}</mat-option>
      </mat-select>
      <mat-error *ngIf="form.get('artistIds')?.invalid && form.get('artistIds')?.touched">Required</mat-error>
    </mat-form-field>

    <div class="dropzone audio-dropzone" (click)="audioFileInput.click()">
     <input #audioFileInput type="file" accept="audio/*" (change)="onAudioFile($event)" hidden>
       <div class="dz-inner">
         <mat-icon>audiotrack</mat-icon>
         <p>Click to replace song file (optional)</p>
       </div>
    </div>
    <p *ngIf="audioFile" class="file-name">Selected audio file: {{ audioFile.name }}</p>

    <div class="dropzone" (click)="fileInput.click()">
      <input #fileInput type="file" accept="image/*" (change)="onFile($event)" hidden>
      <div class="dz-inner">
        <mat-icon>image</mat-icon>
        <p>Replace cover (optional)</p>
      </div>
    </div>
    <p *ngIf="file" class="file-name">{{ file.name }}</p>

    <div class="actions">
      <button mat-stroked-button type="button" (click)="cancel()">Cancel</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">Save</button>
    </div>
  </form>
</div>
